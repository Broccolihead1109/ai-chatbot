<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cool AI Chatbot</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0c0d14;
  --sidebar-bg: #12131e;
  --chat-bg: #181a2b;
  --user-bg: #4b9fff;
  --bot-bg: #25273c;
  --accent: #4b9fff;
  --text: #e0e0e0;
  --scrollbar-bg: #1c1d2a;
  --scrollbar-thumb: #4b4b4b;
}
* { box-sizing: border-box; margin:0; padding:0; font-family:'Inter',sans-serif; }
body { background: var(--bg); color: var(--text); display: flex; flex-direction: column; height: 100vh; }

header { padding:1rem; background: var(--sidebar-bg); font-weight:600; font-size:1.5rem; text-align:center; color:#fff; box-shadow:0 2px 8px rgba(0,0,0,0.4); z-index:10; }

#app { flex:1; display:flex; overflow:hidden; height:calc(100vh - 64px); position:relative; }

#sidebar { width:240px; background:var(--sidebar-bg); border-right:1px solid #222; display:flex; flex-direction:column; padding:0.5rem; transition:transform 0.25s ease,width 0.25s ease; z-index:5; }
#sidebar.hidden { transform: translateX(-100%); width:0; padding:0; }

#toggle-sidebar { position:absolute; left:0; top:64px; width:36px; height:36px; background:var(--accent); color:#fff; border-radius:50%; cursor:pointer; display:flex; justify-content:center; align-items:center; z-index:15; box-shadow:0 2px 8px rgba(0,0,0,0.4); transition:background 0.2s; }
#toggle-sidebar:hover { background:#2e82ff; }

#new-chat { padding:0.75rem; margin:0.5rem 0; border-radius:10px; background:var(--accent); color:#fff; font-weight:500; cursor:pointer; text-align:center; transition:0.2s; }
#new-chat:hover { background:#2e82ff; }

#chat-list { flex:1; overflow-y:auto; margin-top:0.5rem; }

#chat-list button { width:100%; background:#1e1f2f; border:none; padding:0.5rem 0.75rem; margin-bottom:0.4rem; border-radius:8px; text-align:left; color:var(--text); cursor:pointer; display:flex; justify-content:space-between; align-items:center; transition:0.2s; font-weight:500; }
#chat-list button.active { background:var(--accent); color:#fff; }

.rename-btn, .delete-btn { background:transparent; border:none; color:#aaa; cursor:pointer; font-size:0.9rem; margin-left:0.5rem; }
.rename-btn:hover, .delete-btn:hover { color:#fff; }

#main { flex:1; display:flex; flex-direction:column; background:var(--chat-bg); position:relative; overflow:hidden; transition:width 0.25s ease; }

#chat-container { flex:1; display:flex; flex-direction:column; padding:1rem; overflow-y:auto; scrollbar-width:thin; scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-bg); scroll-behavior:smooth; }
#chat-container::-webkit-scrollbar { width:8px; }
#chat-container::-webkit-scrollbar-track { background:var(--scrollbar-bg); }
#chat-container::-webkit-scrollbar-thumb { background:var(--scrollbar-thumb); border-radius:4px; }

.message { max-width:65%; padding:1rem 1.2rem; margin-bottom:0.6rem; border-radius:20px; line-height:1.4; word-wrap:break-word; white-space:pre-wrap; opacity:0; transform:translateY(10px); animation:fadeIn 0.3s forwards; box-shadow:0 2px 6px rgba(0,0,0,0.3); }
.user { background:var(--user-bg); color:#fff; align-self:flex-end; border-bottom-right-radius:4px; }
.bot { background:var(--bot-bg); color:#fff; align-self:flex-start; border-bottom-left-radius:4px; }
@keyframes fadeIn { to { opacity:1; transform:translateY(0); } }

#input-container { display:flex; padding:0.5rem 1rem; background:var(--chat-bg); border-top:1px solid #222; }
#input-container input { flex:1; padding:0.85rem 1rem; border-radius:999px; border:none; outline:none; font-size:1rem; background:#25273c; color:#fff; transition:0.2s; }
#input-container input:focus { background:#2a2b42; }
#input-container button { padding:0.85rem 1.2rem; margin-left:0.5rem; border:none; border-radius:999px; background:var(--accent); color:#fff; font-weight:600; cursor:pointer; transition:0.2s; }
#input-container button:hover { background:#2e82ff; }
</style>
</head>
<body>

<header>Cool AI Chatbot</header>

<div id="app">
  <div id="sidebar">
    <div id="new-chat">+ New Chat</div>
    <div id="chat-list"></div>
  </div>
  <div id="toggle-sidebar">â˜°</div>
  <div id="main">
    <div id="chat-container"></div>
  </div>
</div>

<div id="input-container">
  <input type="text" id="input" placeholder="Ask me anything..." />
  <button onclick="sendMessage()">Send</button>
</div>

<script>
let chats = JSON.parse(localStorage.getItem('chats')) || [];
let activeChat = chats[0] || { id: Date.now(), name: `Chat ${chats.length + 1}`, messages: [] };

function saveChats() { localStorage.setItem('chats', JSON.stringify(chats)); }

function renderChatList() {
  const listEl = document.getElementById('chat-list');
  listEl.innerHTML = '';
  chats.forEach((chat,index)=>{
    const btn=document.createElement('button');
    btn.className=chat.id===activeChat.id?'active':'';
    const nameSpan=document.createElement('span');
    nameSpan.textContent=chat.name||`Chat ${index+1}`;
    nameSpan.style.flex='1';
    btn.appendChild(nameSpan);
    const renameBtn=document.createElement('button');
    renameBtn.textContent='âœŽ';
    renameBtn.className='rename-btn';
    renameBtn.onclick=e=>{ e.stopPropagation(); const newName=prompt('Enter new chat name:',chat.name); if(newName){ chat.name=newName; saveChats(); renderChatList(); } };
    btn.appendChild(renameBtn);
    const deleteBtn=document.createElement('button');
    deleteBtn.textContent='ðŸ—‘';
    deleteBtn.className='delete-btn';
    deleteBtn.onclick=e=>{ e.stopPropagation(); if(confirm('Are you sure you want to delete this chat?')){ chats=chats.filter(c=>c.id!==chat.id); if(activeChat.id===chat.id) activeChat=chats[0]||{id:Date.now(),name:'Chat 1',messages:[]}; saveChats(); renderChatList(); renderChat(); } };
    btn.appendChild(deleteBtn);
    btn.onclick=()=>{ activeChat=chat; renderChat(); renderChatList(); };
    listEl.appendChild(btn);
  });
}

function newChat() { const chat={id:Date.now(),name:`Chat ${chats.length+1}`,messages:[]}; chats.unshift(chat); activeChat=chat; saveChats(); renderChatList(); renderChat(); }

document.getElementById('new-chat').onclick=newChat;
document.getElementById('toggle-sidebar').onclick=()=>{ document.getElementById('sidebar').classList.toggle('hidden'); };
document.getElementById('input').addEventListener('keypress',e=>{ if(e.key==='Enter') sendMessage(); });

function renderChat(){ const container=document.getElementById('chat-container'); container.innerHTML=''; activeChat.messages.forEach(m=>{ const div=document.createElement('div'); div.className='message '+m.role; div.textContent=m.content; container.appendChild(div); }); container.scrollTop=container.scrollHeight; }

async function sendMessage(){ const inputEl=document.getElementById('input'); const message=inputEl.value.trim(); if(!message)return; activeChat.messages.push({role:'user',content:message}); renderChat(); inputEl.value=''; saveChats(); try{ const res=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message})}); const data=await res.json(); activeChat.messages.push({role:'bot',content:data.reply}); renderChat(); saveChats(); } catch(err){ activeChat.messages.push({role:'bot',content:'Error: Could not get response.'}); renderChat(); } }

if(!chats.length)newChat();
else renderChatList(), renderChat();
</script>

</body>
</html>
